{
    "componentChunkName": "component---src-templates-mdx-js",
    "path": "/community/core/docs/adr/0006-thoth-github-action.md",
    "result": {"data":{"site":{"siteMetadata":{"title":"Thoth Station Help"}},"mdx":{"id":"76476eee-dce1-5542-bb7e-68884837c043","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"Thoth GitHub Action ADR\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Status: proposed\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Date: 2022-May-16\")), mdx(\"p\", null, \"Technical Story: we would like to create a new Thoth integration via a GitHub Acttion to advise users on the dependencies used in their repositories.\"), mdx(\"h2\", null, \"Context and Problem Statement\"), mdx(\"p\", null, \"The Thoth GitHub Action was originally supposed to be implemented to advise on the dependencies present in the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/packit/packit\"\n  }, \"Packit repository\"), \", but should be extendable to other repositories as well with different requirement formats (\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"pip\"), \", \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"pipenv\"), \"\\u2026).\"), mdx(\"p\", null, \"The primary goal of this Action would be to advise on the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"security\"), \" aspects of dependencies of a project by providing a mean to:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Identify CVE present in the versions of the packages used in the project, so that users can eventually block Pull Requests introducing vulnerable dependencies\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Comment on the Pull Requests with a list of CVE found for the current package versions\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Log all stack info in the action workflow\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Provide a link to Thoth Search UI to browse the advise results\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Fail the workflow to eventually block the Pull Request\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Get security insights on the dependency stack introduced by a Pull Request by returning the content of the stack info (Security Scorecards data, warnings, info, etc)\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Log stack info in the action workflow\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Provide a link to Thoth Search UI to browse the advise results\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Score the current dependency stack and allow repository maintainers to display this score as a badge in the landing page of their repository as an indicator of application dependencies health\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Get the software stack score provided in the advise result and normalize it if needed\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Create a \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://docs.github.com/en/actions/monitoring-and-troubleshooting-workflows/adding-a-workflow-status-badge\"\n  }, \"status badge\"), \" for the workflow running the Thoth GitHub Action indicating the score of the software stack on the merge of a Pull Request modifying the requirements file.\")))), mdx(\"h2\", null, \"Considered Options\"), mdx(\"h3\", null, \"Setting up the Action on a repository\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"name: User CI workflow\\non:\\n  push:\\n    paths:\\n      - 'requirements.txt'\\n      - 'Pipfile'\\njobs:\\n  validate-dependencies:\\n    runs-on: ubuntu-latest\\n    name: Get Thoth recommenations on your dependencies\\n    steps:\\n      - uses: actions/checkout@v3\\n      - uses: actions/setup-python@v2\\n        with:\\n          python-version: 3.8\\n      - name: Get Thoth security advisories\\n        id: thoth-advise\\n        uses: thoth-station/thoth-github-action@v1\\n        with:\\n          path: './requirements.txt'\"))), mdx(\"p\", null, \"The Thoth GitHub Action requires prior actions already available on the GitHub Marketplace to work on a repository Pull Request workflow, such as \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/actions/checkout\"\n  }, mdx(\"code\", {\n    parentName: \"a\",\n    \"className\": \"language-text\"\n  }, \"actions/checkout\")), \" to checkout the current repository or \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/actions/setup-python\"\n  }, mdx(\"code\", {\n    parentName: \"a\",\n    \"className\": \"language-text\"\n  }, \"actions/setup-python\")), \" to set up a Python environment where the Python parts of the Action can be run:\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"steps:\\n  - uses: actions/checkout@v3\\n  - uses: actions/setup-python@v2\\n    with:\\n      python-version: 3.8\\n\"))), mdx(\"p\", null, \"To trigger the workflow only when necessary, it can be configured to trigger the Action on a \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"push\"), \" event which modifies the dependency requirements file of the project (\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Pipfile\"), \", \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"requirements.txt\"), \", etc):\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"on:\\n  push:\\n    paths:\\n      - 'requirements.txt'\\n      - 'Pipfile'\"))), mdx(\"h3\", null, \"Thoth GitHub Action architecture\"), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"./images/Thoth-GitHub-Action-ADR.drawio.png,\",\n    \"alt\": \"Thoth GitHub Action diagram\",\n    \"title\": \"Thoth GitHub Action architecture diagram using Thamos CLI to generate advise\"\n  })), mdx(\"p\", null, \"Possible alternatives would be to:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Make a call directly to the User API via a bash script to avoid issues linked to the creation of a \", mdx(\"code\", {\n    parentName: \"li\",\n    \"className\": \"language-text\"\n  }, \".thoth.yaml\"), \" configuration file and to use a Python script to process the advise result only\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Use Thamos as a library to get the advise result\")), mdx(\"p\", null, \"However, those options would not be as easily maintainable.\"), mdx(\"h2\", null, \"Decision Outcome\"), mdx(\"p\", null, \"To be done.\"));\n}\n;\nMDXContent.isMDXComponent = true;","fields":{"srcLink":"https://github.com/thoth-station/core/blob/master/docs/adr/0006-thoth-github-action.md"},"frontmatter":{"title":"","description":null}}},"pageContext":{"id":"76476eee-dce1-5542-bb7e-68884837c043"}},
    "staticQueryHashes": ["1276261476","2902925331","3000541721","489485899"]}